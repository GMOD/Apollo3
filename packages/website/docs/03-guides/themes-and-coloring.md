# Themes and coloring

## Theme

When Apollo is running in JBrowse, it sets a different default theme from the
standard JBrowse theme. The theme can also be configured. Refer to the
[JBrowse guide](jbrowse#how-to-edit-the-jbrowse-configjson) for information on
how to edit JBrowse's `config.json` and JBrowse's
[theming guide](https://jbrowse.org/jb2/docs/config_guides/theme/) for
instructions on how to customize the theme in the `config.json`.

## Custom gene background

For gene and gene-like features, you can customize the background color of the
gene based on its type (_i.e._ according to the value in the 3rd column of a GFF
file). For example, you can set different coloring for `pseudogene`s or
`ncRNA_gene`s.

This configuration is done in the `config.json`. See the
[JBrowse guide](jbrowse#how-to-edit-the-jbrowse-configjson) for information on
how to edit JBrowse's `config.json`.

To add this configuration the the `config.json`, add an entry for
`geneBackgroundColor` under the `ApolloPlugin` section of the top-level
`configuration` entry. The configuration file generated by Apollo should already
contain the `ApolloPlugin` slot, but if it doesn't make sure to create it. For
example, the `ApolloPlugin` slot may look like:

```json title="excerpt from config.json"
{
  "configuration": {
    "ApolloPlugin": {
      "geneBackgroundColor": "jexl: featureType == 'pseudogene' ? 'rgba(148, 203, 236, 0.6)' : featureType == 'ncRNA_gene' ? 'rgba(194, 106, 119, 0.6)': undefined"
    }
  }
}
```

The value of `geneBackgroundColor` is a string representing a
[`jexl`](https://www.npmjs.com/package/jexl) expression that assigns a color to
a toplevel feature. Some notes on the `jexl` expression:

- `if-else` and loop statements are not allowed and they should be replaced with
  nested ternary operators as in the example above
- The expression should be written on a single line to comply with the JSON
  format.
- The color string should be a valid
  [CSS color](https://developer.mozilla.org/en-US/docs/Web/CSS/color)

The example above assigns custom colors to features of type _pseudogene_ and
_ncRNA_gene_ and leaves all the other feature types as default color (since the
ternary operators fall back to `undefined`). Most likely, you want to make the
background color to be slightly transparent by setting, for example, the fourth
argument of the `rgba` function (0.6 in the example).

For more information see also the documentation for using
[jexl in JBrowse](https://jbrowse.org/jb2/docs/config_guides/jexl/).
